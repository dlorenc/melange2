package:
  name: fetch-test
  version: 1.0.0
  epoch: 0
  description: Test fetch pipeline for downloading sources
  copyright:
    - license: MIT

pipeline:
  - name: setup
    runs: |
      mkdir -p ${{targets.destdir}}/usr/share/fetch-test

  - name: fetch-with-curl
    runs: |
      # Test basic HTTP fetch using curl (available in alpine)
      # Use a reliable, small file
      curl -sSL -o /tmp/robots.txt https://www.google.com/robots.txt
      test -f /tmp/robots.txt || exit 1
      cp /tmp/robots.txt ${{targets.destdir}}/usr/share/fetch-test/fetched.txt

  - name: verify-fetch
    runs: |
      # Verify the file was fetched and has content
      test -s ${{targets.destdir}}/usr/share/fetch-test/fetched.txt || exit 1
      echo "fetch successful" > ${{targets.destdir}}/usr/share/fetch-test/status.txt
